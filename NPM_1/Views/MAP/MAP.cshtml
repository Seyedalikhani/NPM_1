<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>




<!-- Top panel with filters -->
<div style="background-color: pink; padding: 10px; display: flex; flex-wrap: wrap; align-items: flex-start; gap: 20px; font-size: 14px;">

    <!-- Province -->
    <div>
        <label style="font-size: 16px;">Province:</label><br />
        @Html.DropDownList(
            "Dropdown_province",
            new SelectList(new[] {
                "ALBORZ", "ARDABIL", "BUSHEHR", "CHAHARMAHAL BAKHTIARI", "EAST AZERBAIJAN",
                "ESFAHAN", "FARS", "GILAN", "GOLESTAN", "HAMEDAN", "HORMOZGAN", "ILAM",
                "KERMAN", "KERMANSHAH", "KHORASAN RAZAVI", "KHOUZESTAN", "KOHGILUYEH AND BOYER AHMAD",
                "KORDESTAN", "LORESTAN", "MARKAZI", "MAZANDARAN", "NORTH KHORASAN", "QAZVIN",
                "QOM", "SEMNAN", "SISTAN VA BALUCHESTAN", "SOUTH KHORASAN", "TEHRAN",
                "WEST AZERBAIJAN", "YAZD", "ZANJAN"
            }),
            "Select Province",
            new
            {
                @id = "Dropdown_province",
                @class = "form-control",
                style = "width: 250px; font-size: 13px;" // Set your desired width here
            }
        )


        @*<label for="Dropdown_province">Province:</label>
        @Html.DropDownList("Dropdown_province", new SelectList(ViewBag.ProvinceList), "Select Province", new { @id = "Dropdown_province" })*@

    </div>

    <!-- Site Code -->
    <div>
        @* <label style="font-size: 16px;">Site Code:</label><br />*@
        <label for="siteCodeDropdown">Site Code:</label><br />
        @*<select id="siteCodeDropdown" class="form-control" style="font-size: 13px;">*@
        @Html.DropDownList("siteCodeDropdown", new SelectList(ViewBag.SiteList), "Select Site", new { @id = "siteCodeDropdown" })
        @*</select>*@
    </div>




    <!-- Band Info in 3 Rows -->
    <div>
        <label style="font-size: 16px;">Band:</label><br />
        <div style="font-size: 13px;">
            <!-- Row 1 -->
            <div style="display: flex; gap: 10px; margin-bottom: 5px;">
                <label><input type="checkbox" checked> G900</label>
                <label><input type="checkbox" checked> G1800</label>
            </div>

            <!-- Row 2 -->
            <div style="display: flex; gap: 10px; margin-bottom: 5px;">
                <label><input type="checkbox" checked> U900</label>
                <label><input type="checkbox" checked> U2100</label>
            </div>

            <!-- Row 3 -->
            <div style="display: flex; gap: 10px;">
                <label><input type="checkbox" checked> L1800</label>
                <label><input type="checkbox" checked> L2100</label>
                <label><input type="checkbox" checked> L2600</label>
            </div>
        </div>
    </div>

    <!-- Site Type in 3 Rows -->
    <div>
        <label style="font-size: 16px;">Site Type:</label><br />
        <div style="display: flex; flex-direction: column; font-size: 13px;">
            <label><input type="checkbox" checked> Macro</label>
            <label><input type="checkbox" checked> Micro</label>
            <label><input type="checkbox" checked> Pico</label>
        </div>
    </div>

    <!-- Node Name -->
    <div>
        <label style="font-size: 16px;">Node Name:</label><br />
        <select id="nodeDropdown" class="form-control" style="font-size: 13px;">
            <option value="">--Select Node--</option>
            <!-- Populate dynamically -->
        </select>
    </div>

    <!-- Tool Buttons -->
    <div style="display: flex; flex-direction: row; gap: 10px; align-items: center;">
        <button class="btn btn-primary" style="font-size: 13px;">Distance</button>
        <button class="btn btn-primary" style="font-size: 13px;">Area</button>
        <button class="btn btn-success" style="font-size: 13px;">Export</button>
    </div>

</div>



<div id="map" style="height: 530px;"></div>


<script>
    var map = L.map('map').setView([35.7331085205078, 51.4947395324707], 13); // Tehran coords as example

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: '© OpenStreetMap'
    }).addTo(map);

    // Optional: Add a marker
    //L.marker([35.7331085205078, 51.4947395324707]).addTo(map)
    //    .bindPopup('Tehran')
    //    .openPopup();



    $(document).ready(function () {
        $('#Dropdown_province').change(function () {
            var province = $(this).val();
            if (!province) return;

            $.ajax({
                url: '@Url.Action("GetLocations", "MAP")',
                type: 'POST',
                data: { selected_province: province },
                success: function (sites) {
                    let $siteDropdown = $('#siteCodeDropdown');
                    $siteDropdown.empty();
                    $siteDropdown.append('<option value="">Select Site</option>');
                    $.each(sites, function (index, site) {
                        $siteDropdown.append('<option value="' + site + '">' + site + '</option>');
                    });
                },
                error: function (xhr, status, error) {
                    console.error("AJAX error:", status, error);
                }
            });
        });
    });


</script>


